<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "User_Guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-configuration-options">
	<title>How to use Nested Buffers in BlackTie</title>

	<section>
		<title>Defining a schema</title>
		<para>
			Nested Buffer Format is defined in a xsd schema file, such as
			employee.xsd:
		</para>
		<para>
			<programlisting language="XML" role="XML"><xi:include
				href="extras/employee.xsd" xmlns:xi="http://www.w3.org/2001/XInclude"
				parse="text" /></programlisting>
		</para>
		<para>All xsd schema files should been placed in buffers directory.
		</para>
		<para>Get a nested buffer in blacktie, you should use</para>
		<para>
			<programlisting language="Java" role="JAVA">char* buffer = tpalloc("BT_NBF", "&lt;buffer_name&gt;", 0);  // in C++
BT_NBF buffer = (BT_NBF) connection.tpalloc("BT_NBF", "&lt;buffer_name&gt;", 0);   // in Java</programlisting>
		</para>
		<para>After that, the following options are available:</para>
		<itemizedlist>
			<listitem>
				<para>add a new attribute in buffer</para>
				<para>int btaddattribute(char** buf, char* attributeId, char*
					attributeValue, int len); // in C++</para>
			</listitem>
			<listitem>
				<para>retrieve a set attribute</para>
				<para>int btgetattribute(char* buf, char* attributeId, int
					attributeIndex, char* attributeValue, int* len); // in C++</para>
			</listitem>
			<listitem>
				<para>set an existing attribute</para>
				<para>int btsetattribute(char** buf, char* attributeId, int
					attributeIndex, char* attributeValue, int len); // in C++</para>
			</listitem>
			<listitem>
				<para>remove an existing attribute</para>
				<para>int btdelattribute(char* buf, char* attributeId, int
					attributeIndex); // in C++</para>
			</listitem>
		</itemizedlist>
		<para>e.g.</para>
		<para>
			<programlisting language="C++" role="C++"><xi:include
				href="extras/bufferedit.c" xmlns:xi="http://www.w3.org/2001/XInclude"
				parse="text" /></programlisting>
		</para>
		<para>more examples can be founded under &lt;BLACKTIE_HOME&gt;/example/nbf, and this example  also runs as part of the run_all_samples script.</para>
	</section>
</chapter>

