<project name="foo">

	<target name="init">
		<delete dir="${BT_HOME}${VERSION}"/>
		<mkdir dir="${BT_HOME}"/>
		<condition property="is-msvc">
			<os family="windows" />
		</condition>
	</target>

	<target name="_extract-gcc" depends="init" unless="is-msvc">
		<exec executable="tar">
			<arg line="xfz ../../blacktie/target/${VERSION}-${bpa}-bin.tar.gz -C ${BT_HOME}"/>
		</exec>
	</target>

	<target name="_extract-msvc" depends="init" if="is-msvc">
		<unzip dest="${BT_HOME}">
			<fileset dir="../../blacktie/target/">
				<include name="${VERSION}*-bin.zip"/>
			</fileset>
		</unzip>
	</target>

	<target name="dist" depends="_extract-msvc,_extract-gcc">
		<replaceregexp byline="true" match="REPLACE_WITH_INSTALL_LOCATION" replace="${BT_HOME}${VERSION}">
			<fileset dir="${BT_HOME}/">
				<include name="*/setenv.*"/>
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="REPLACE_WITH_HOSTNAME" replace="${MACHINE_ADDR}">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="${MACHINE_ADDR}:" replace="${JBOSSAS_IP_ADDR}:">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="HOST=&quot;${MACHINE_ADDR}&quot;" replace="HOST=&quot;${JBOSSAS_IP_ADDR}&quot;">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="REPLACE_WITH_HOSTNAME" replace="${JBOSSAS_IP_ADDR}">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/pom.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="localhost" replace="${JBOSSAS_IP_ADDR}">
			<fileset dir="${BT_HOME}${VERSION}">
				<include name="**/examples/admin/jmx/src/test/java/org/jboss/blacktie/examples/jmx/*.java"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="&lt;!-- DB2 support -->" replace="&lt;!--">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="&lt;!-- END DB2 support -->" replace="-->">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="DB=blacktie" replace="DB=ORCL.NCL">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="SqlNet=blacktie" replace="SqlNet=orcl112">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/btconfig.xml"/>
			</fileset>
		</replaceregexp>
		<replaceregexp byline="true" match="blacktie" replace="ORCL.NCL">
			<fileset dir="${BT_HOME}${VERSION}/">
				<include name="**/request.c"/>
			</fileset>
		</replaceregexp>
	</target>
</project>
